
\section{Chapter 2}
\subsection {Theoretical Background }
%Where does your problem come from? (you’ll have to talk about stochastic PDEs, volatility, assets price modeling, martingales, etc.) 
First of all we will introduce Stochastic Differential Equations. 
 SDE are being used in various fields for example biology, physics, mathematics and of course finance. 
 In finance, SDE is used to model asset price included with Brownian motion. 
 Here we will use constant parameters drift and diffusion coeficients. 
 With these constants , we will use euler muruyama method to model asset price. \\
 In this chapter, we will focus on numerical solution of stochastic differential equations (SDE). It will give us better understanding toward the theory behind SDE. SDE are used in various areas like biology, chemistry, economics and of course finance. We will also study Brownian motion and compute Brownian paths with different methods. Euler -Maruyama method, strong and weak convergence , milstein method are being used to show solutions of SDE. \\
 Now let's start with finance knowledge, Suppose the market price of an asset increases significantly.  How can one determine if the market price is inflated
above the actual price of an asset? This price behavior is know as a bubble.\\
To model price bubbles, we want to consider the following:
\begin{itemize}
\item What is an asset price bubble?
\item How does one determine if an asset price is experiencing a bubble?
\item Can one detect an asset price bubble in \textit{real-time}?
\end{itemize}
Lets's consider finance definations :\\
\begin{itemize}
\item Market Price - The current price of an asset.
\item Fundamental Price - The actual value of an asset based on an underlying perception of its \textit{true value}.
\item Risk - Variance of return on an asset 
\item Portfolio - Set of Assets.

\item Asset Bubble- The difference between the market and fundamental price, if any, is a price bubble.
 
 \item Strike price -The strike price or exercise price of an option is the fixed price at which the owner of the option can buy( in the case of call) or sell (in the case of a put) the underlying security or commodity.

\item Volatility-Rate at which the price of security moves up and down.
\end{itemize} 
\subsection {Probability Measure}
\subsubsection{Probability Space} ($\Omega,\mathcal{F},P$) where $\Omega$ is a set ( sample space), $\mathcal{F}$ is a sigma
algebra of subsets (events) of $\Omega$, and $P$ is a Probability Measure.
 \subsubsection{Random Variable} - Measurable functions of real analysis.
$X:\Omega\rightarrow \mathcal{R}$ map $X : (\Omega,\mathcal{F})\mapsto (\mathcal{R}, \mathcal{B})$ and $X$ is random variable if \\
$X^{-1}(A) \epsilon \mathcal{F}, \forall A \epsilon\mathcal{B})$,\\
where $X^{-1}(A):={\omega \epsilon \Omega\mid X(\omega) \epsilon A}$

\subsection{ Stochastic Differential Equations}
We treat the asset price as a stochastic process:\\\\
\subsubsection{Stochastic Process}\\
Given a probability space $\left( \Omega, \mathcal{F}, P \right) $, a stochastic process with state space X is a
collection of X-valued random variables, $S_t$, on $\Omega$ indexed by a set $T$ (e.g. time).
\begin{equation}\label{eqnModelling2-1}
S = \left\lbrace S_t : t\in T \right\rbrace 
\end{equation}

One can think of $S_t$ as a asset price at time $t$.\\\\
\subsubsection{Stochastic Differential Equation}\\
A differential equation with one or more terms is a stochastic process.

\subsection{Brownian Motion} $\left\lbrace S_t: 0\leq t\leq T\right\rbrace$:
\begin{equation}\label{eqnModelling4-1}
\begin{array}{rcl}
dS_t &=& \sigma(S_t)dW_t+\mu(S_t)dt\\
S_0 &=& 0
\end{array}
\end{equation}
\begin{itemize}
\item $W_{t}$ denotes the standard Brownian Motion.
\item $\mu(S_{t})$ called the drift coefficient.
\item $\sigma(S_{t})$ called the volatility coefficient.
\end{itemize}
%%%%%Modelling Page 3%%%%
\subsubsection{Defination of Brownian motion}
A continuous-time stochastic process $\left\lbrace S_{t}: 0\leq t\leq T\right\rbrace$ is called a \textit{Standard
Brownian Motion} on $ \left[ 0, T\right]$ if it has the following four properties:
\begin{itemize}
\item[(i)]$S_{0} =0$
\item[(ii)] The increment of $S_{t}$ are independent; given $$0\leq t_{1}< t_{2}< t_{3}<\cdots<t_{n}\leq T$$ the random
variables $\left( S_{t_{2}} -S_{t_{1}}\right)$, $\left(S_{t_{3}} -S_{t_{2}} \right)$, $\cdots$, $\left( S_{t_{n}}
-S_{t_{n-1}}\right)$  are independent.
\item[(iii)]$\left( S_{t} -S_{s}\right)$, $0\leq s\leq t\leq T$ has the Gaussian distribution with mean zero and
variance $\left( t-s \right) $
\item[(iv)]$S_{t}(W)$ is a continuous function of $t$, where $W \in \Omega$.
\end{itemize} 


%%%%%Modelling Page 5%%%%
\subsection{Martingales}
\begin{itemize}
\item[(a)] $E[ \mid S_{n}\mid]< +\infty$, for all n.
\item[(b)] $S_n$ is said to be \textit{adapted} if and only if $S_{n}$ is $\mathcal{F}_{n}$-measurable. 
\end{itemize} 
The stochastic process $S = \displaystyle{\left\lbrace S_n \right\rbrace_{n=0}^\infty}$ is a \textit{martingale} with
respect to $\left( \lbrace\mathcal{F}_{n}\rbrace, P \right)$  if $E[ S_{n+1}\mid \mathcal{F}_{n}] = S_{n}$, for all n,
almost surely and:
  \begin{itemize}
  \item S satifies (a) and (b).
  \end{itemize}
\subsection{Supermartingale}\\\\
The stochastic process $S = \displaystyle{\left\lbrace S_n \right\rbrace_{n=0}^\infty}$ is a \textit{supermartingale}
with respect to $\left( \lbrace\mathcal{F}_{n}\rbrace, P \right)$  if $E[ S_{n+1}\mid \mathcal{F}_{n}] \leq S_{n}$, for
all n, almost surely and:
  \begin{itemize}
  \item S satifies (a) and (b).
  \end{itemize}
 \subsection{Local Martingale}\\\\
If $\left\lbrace S_n \right\rbrace$ is adapted to the filtration $\left\lbrace \mathcal{F}_n \right\rbrace $, for all $0
\leq t\leq \infty$, then $\left\lbrace S_n: 0 \leq t \leq \infty \right\rbrace$ is called a \textit{local martingle}
provided that there is nondecreasing sequence $\left\lbrace \tau_k \right\rbrace $ of stopping times with the property
that $\tau_k \rightarrow \infty$ with probability one as $k \rightarrow \infty$ and such that for each $k$, the process
defined by
$$S_t^{(k)} = S_{t \wedge \tau_k} - S_0$$ for $t \in [0 , \infty)$ is a martingale with respect to the filtration
$$\left\lbrace \mathcal{F}_n : 0 \leq t < \infty \right\rbrace$$
\subsection{Remark}\\
 A strict local martingale is a non-negative local martingale.

\subsection{Theorem}\\
 If for any strict local martingale $$\left\lbrace S_t : 0 \leq t \leq T\right\rbrace $$ with $E \left[ \left\vert S_0
\right\vert \right] < \infty$ is also a supermartingale and $E \left[ S_T \right] = E \left[ S_0 \right] $, then
$\left\lbrace S_t : 0 \leq t \leq T\right\rbrace $ is in fact a martingale. \\\\
\subsection{Remark}
\begin{itemize}
\item $\left\lbrace S_t : 0 \leq t \leq T\right\rbrace $ is a supermartingale and a martingale if and only if it
has constant expectation.\item For a strict local martingale its expectation decreases with time.
\end{itemize} 

\subsection{Relating Martingales and Bubbles}\\\\
\subsection{theorem}
 $\left\lbrace S_t : 0 \leq t \leq T\right\rbrace $ is a strict local martingale if and only if
\begin{equation}\label{eqnMartingalesAndBubbles4-1}
\int_\alpha^\infty \frac{x}{\sigma^2(x)}dx < \infty
\end{equation} 
for all $\alpha > 0$.

\begin{itemize}
\item A bubble exists if and only if (\ref{eqnMartingalesAndBubbles4-1}) is finite.
\item We shall call (\ref{eqnMartingalesAndBubbles4-1}) the volatility of asset return.
\end{itemize} 
\begin{itemize}
\item In this scope, the difference between a martingale and a strict local martingale is whether the volatility of
asset return, (\ref{eqnMartingalesAndBubbles4-1}), is finite or not finite.
\end{itemize}

\subsection{Numerical Methods of SDE}
For $t \in [0,T]$, $(\ref{eqnModelling4-1})$ can be represented in an integral form in the following way:
\begin{eqnarray*}
dS_t &=& \sigma(t)dW_t+\mu(t)dt\\
\int_0^t dS_t &=& \int_0^t \sigma \left(S_t\right)dW_t+\int_0^t \underbrace{\mu\left(S_t\right)}_{\in
\mathcal{R}^+}dt\\
S_t - S_0   &=& \int_0^t \sigma\left(S_t\right)dW_t+ \left( \underbrace{\mu\left(S_t\right) \cdot t}_{ x_0} -
\mu\left(S_t \right) \cdot 0\right) \\
S_t &=& x_0 + \int_0^t \sigma\left(S_t\right)dW_t
\end{eqnarray*} 

%%%%%Modelling Page 6%%%%
\subsubsection{What is $S_t = x_0 + \int_0^t \sigma\left(S_t\right)dW_t$ ?}
The price model is
\begin{equation}\label{eqnModelling6-1}
S_t = x_0 + \int_0^t \sigma\left(S_t\right)dW_t
\end{equation}

%%%%%Modelling Page 7%%%%
\subsubsection{ What is $S_t = x_0 + \int_0^t \sigma\left(S_t\right)dW_t$ ?}

\begin{equation}
\begin{array}{rcl}
dS_t &=& \mu(S_t)dt+\sigma(S_t)dW_t\\
S_0 \in \mathcal{R}
\end{array}
\end{equation}
\subsubsection{The Euler-Maruyama Method}
Equation (4) can be written into integral form as:\\
\begin{equation}
\begin{array}{rcl}
S_t =S_0+ \int_0^t f\left(S_s\right)ds +\int_0^t g\left(S_s\right)dW(s),      t\in [0,T]\\
\end{array}
\end{equation}
f, g are scaler function with $S_0 = x_0$\textbf{‚Ä¢} random variable\\
$$\begin{cases}
dS_t = \mu(S_t)dt+\sigma(S_t)dW_t\\
S(0) = S_0
\end{cases}$$
 Using Euler Maruyama method:\\
 $w_0 = S_0$\\\\
 $w_{i+1} = w_i+a(t_i,w_i) \bigtriangleup t_{i+1}+b(t_i,w_i)\bigtriangleup W_{i+1}$\\\\
 $w_{i+1} = w_i+\mu w_i \bigtriangleup t_i+\sigma w_i\bigtriangleup W_i$\\\\
 $\bigtriangleup t_{i+1} = t_{i+1}-t_i$\\\\
 $\bigtriangleup W_{i+1} = W(t_{i+1}-W(t_i)$\\
Now drift coefficient $\mu$ and diffusion coefficient $\sigma$ are constants, the SDE has an exact solution:
\begin{equation}\label{eqnModelling7-2}
S(t) = S_0 \cdot Exp \left( \left( \mu - \frac{1}{2} \sigma^2 \right)t + \sigma W(t) \right) 
\end{equation} 

%%%%%Modelling Page 9%%%%
\subsection{ What is $S_t = x_0 + \int_0^t \sigma\left(S_t\right)dW_t$ ?}
\begin{equation}
S(t) = S_0 \cdot Exp \left( \left( \mu - \frac{1}{2} \sigma^2 \right)t + \sigma W(t) \right) 
\end{equation} 
For an example, we use the Euler-Maruyama Approximation Method on the SDE where the constants $\mu = 2$, $\sigma = 1$,
and $S_0 = 1$ are given.


There are other methods such as Strong and weak convergence of the Euler Muruyama method, Milstein's Higher Order Method, Linear Stability and Stochastic Chain Rule are also used for numerical solutions for SDE.
\begin{itemize}
\item From this, we will focus on real time stock data. We will have couple estimators to determine volatility function. For instance, 
\item We will assume that $\sigma$ is not constant.  We will approximate $\sigma$ with non parametric estimator method on local time.
\end{itemize} 


%(2.2) Describe the math problem: parametric estimation, interpolation, extrapolation, minimization
\subsection{Methods used to solve the problem}
In this classical setting, Jarrow, Protter, and Shimbo [19], [20] show that there are three types of asset price bubbles possible. 
Two of these price bubbles exist only in infinite horizon economies, the third—called type 3 bubbles—exist in finite horizon settings. 
Consequently, type 3 bubbles are those most rele- vant to actual market experiences. 
For this type of bubble, saying whether or not a bubble exists amounts to determining whether the price process under a risk neutral measure is a martingale or a strict local martingale: if it is a strict local martingale, there is a bubble.

 Stock price is strict local martingale if and only if \\
\begin{equation}
\int_\alpha^\infty \frac{x}{\sigma\left(x\right)}dx < \infty  for all \alpha >0
\end{equation} 
 Floren Zmirou's non parametric estimator is based on the local time of the Diffusion Process.
 \subsubsection{Diffusion Process}
 In probability theory, a branch of mathematics, a diffusion process is a solution to a stochastic differential equation. 
 It is a continuous-time Markov process with almost surely continuous sample paths.\\
 \subsection{Floren Zmirou}
 Lets consider following equation:
 \begin{equation}
S_t = S_0 + \int_0^t \sigma\left(S_t\right)dW_t
\end{equation}
In Floren Zmirou, the drift coefficient $\mu(S_{t})$ is null which is ignored without loss of generality. 
It is not involved in our problem. $\sigma(S_{t})$ the volatility coefficient is unknown. We will follow steps for Floren Zmirou method:\\
\begin{itemize}
  \item $(S_t_1\ldots S_t_n)$ are the stock prices in the interval $t_1\ldots t_n \in [0,T]$
  \item Without loss of generality, we assume T = 1, therefore $t_i = i/n$
\end{itemize}
Estimator as follows:\\
Local time = $l_T(x)= lim_{\epsilon\longrightarrow 0} \frac{1}{2 \epsilon} \int_0^T 1_{\{|S_s-x|<\epsilon\}} d \langle S,S\rangle_s$\\\\
where $d \langle S,S\rangle_s = \sigma^2(S_{s})$\\\\
$L_T(x)= lim_{\epsilon\longrightarrow 0} \frac{1}{2 \epsilon} \int_0^T 1_{\{|S_s-x|<\epsilon\}} dS$\\\\
$\Longrightarrow l_T(x) = \sigma^2(S_{s})L_T(x)$\\\\
$\Longrightarrow l_T(x)\L_T(x) = \sigma^2(S_{s})$\\\\
Now we will define local time of $S_{s}$ in $x$ during [0,t].\\\\
Let's assume that $nh_n \rightarrow \infty$ and $h_n\rightarrow 0$\\\\
$\Longrightarrow L^n_{T}(x)= \frac{T}{2nh_n}\Sigma_{i=1}^{n} 1_{\{|S_{t_i}-x|<h_n\}} $\\\\
estimator of $\sigma^2(S_{x})$ as follows:\\\\
$S_n(x) = \frac{\Sigma_{i=1}^{n} 1_{\{|S_{t_i}-x|<h_n\}} n (S_{t_i+1}-S_{t_i})^2}{\Sigma_{i=1}^{n} 1_{\{|S_{t_i}-x|<h_n\}}}$\\\\
\subsection {Theorem}
If $Sigma$is bounded above and below from zero, has three continuous and bounded
derivatives, and if $(h_n)_n≥1 $satisfies $nh_n\rightarrow \infty $ and $nh_4n\rightarrow 0$, then $S_n(x)$ is a consistent estimator of $\sigma^2(x)$.\\

Now we have $\sigma^2(x)$ and we will use interpolation methods to see function's behaviour. 

\subsection{Interpolation}
Interpolation is a method of constructing new data points within the range of a discrete set of known data points. There are many methods to do interpolation. 
For example Linear Interpolation,polynomial interpolation, piecewise constant interpolation, spline interpolation.
Here we will interpolate an estimate of $\sigma^2(x_i)$ where $i \in [1.M]$ within the bounded finite interval $D$ where we have observations.
We used cubic spline interpolation and Reproducing Kernal Hilbert Spaces to get interpolation function.\\
\begin{itemize}
\item Interpolation is seen as inverse problem.
\item We will have two types of solutions for inverse problem.
\end{itemize}
\subsubsection{Normal Solution}
It will allows an exact interpolation with minimal squared norm.
\subsubsection{Regularized Solution}
it will yields quasi interpolative results, accompained by an error bound analysis with Tikhonov Regularization produces an approximate solution $f_\alpha$ which belongs to $H(D)$and that can be obtained via the minimization of the regularization functional.
\subsubsubsection {Regularized solution with Kernal function}
For interpolation, we denote kernal function $K^{a,b}_{n,\tau}$ for n =1 and n = 2. of $H^n(a,d)$ where $D = (a,b)$


 
